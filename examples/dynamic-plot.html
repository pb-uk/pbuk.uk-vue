<!DOCTYPE html>
<html>
  <head>
    <title>Dynamic plot example</title>
    <link rel="stylesheet" href="../dist/pbuk-vue.min.css" />
    <script defer src="https://unpkg.com/vue@next"></script>
    <script defer src="../dist/pbuk-vue.min.js"></script>
  </head>
  <body>
    <div id="app">
      <h2>Example 2d plot</h2>
      <visualize-dom @loaded="onLoad2d" style="max-width: 50vh"></visualize-dom>
      {{ message }}
    </div>
    <script>
      var app = {
        setup() {
          const { Visualize2d } = PbukVue;

          let plot2d;

          const onLoad2d = (el) => {
            const trailPoints = 20;
            const frameTimeMs = 20;
            plot2d = new Visualize2d(el, {
              aspectRatio: '1:1',
              axes: [
                // x axis.
                { range: [-1, 1] },
                // y axis.
                { range: [-1, 1] },
              ],
              data: [{ trailPoints }],
            });

            const started = performance.now();
            let t = 0;
            const interval = setInterval(() => {
              for (let i = 0; i < trailPoints; ++i) {
                plot2d.plot([Math.cos(t), Math.sin(t)]);
                t += 0.01;
              }
              if (performance.now() - started > 10000) {
                clearInterval(interval);
              }
            }, frameTimeMs);
          };

          return {
            message: 'Hello!',
            onLoad2d,
          };
        },
      };
    </script>
  </body>
</html>
